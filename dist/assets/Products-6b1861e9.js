import{r as m,k as C,d as tt,_ as st,l as et,o as c,c as d,u as o,a as t,b as I,t as a,w as N,m as lt,p as K,q as W,F as O,e as Q,n as g,s as X}from"./index-a28efa19.js";import{p as E,a as R}from"./index-a72ad2f1.js";import{s as _}from"./swal-52a55870.js";function ot(){const r=m([]),S=m([]),f=m(!1),b=m(null),y=m(""),$=m(""),k=m(""),h=m("name"),M=m("grid"),B=m(1),w=m(12),p=async()=>{f.value=!0,b.value=null;try{const[l,n]=await Promise.all([E.getProducts(),E.getCategories()]);r.value=l,S.value=n}catch(l){b.value=R.formatError(l),console.error("Error loading products:",l)}finally{f.value=!1}},u=C(()=>{let l=r.value;return y.value&&(l=l.filter(n=>n.name.toLowerCase().includes(y.value.toLowerCase())||n.sku.toLowerCase().includes(y.value.toLowerCase()))),$.value&&(l=l.filter(n=>n.category===$.value)),k.value&&(l=l.filter(n=>D(n.stock)===k.value)),l.sort((n,i)=>{switch(h.value){case"name":return n.name.localeCompare(i.name);case"price":return n.price-i.price;case"stock":return i.stock-n.stock;case"date":return i.createdAt-n.createdAt;default:return 0}}),l}),j=C(()=>r.value.length),T=C(()=>r.value.filter(l=>l.stock>10).length),x=C(()=>r.value.filter(l=>l.stock>0&&l.stock<=10).length),q=C(()=>r.value.filter(l=>l.stock===0).length),z=C(()=>Math.ceil(u.value.length/w.value)),G=l=>l===0?"หมดสต็อก":l<=10?"สต็อกต่ำ":"ในสต็อก",D=l=>l===0?"out-of-stock":l<=10?"low-stock":"in-stock",V=l=>l===0?"bg-danger":l<=10?"bg-warning":"bg-success",Y=l=>new Intl.NumberFormat("th-TH",{style:"currency",currency:"THB"}).format(l),A=l=>new Intl.DateTimeFormat("th-TH",{year:"numeric",month:"short",day:"numeric"}).format(l),L=async l=>{try{f.value=!0;const n=await E.createProduct(l);return r.value.push(n),await _.success("เพิ่มสินค้าสำเร็จ!",`สินค้า "${n.name}" ถูกเพิ่มแล้ว`),n}catch(n){throw b.value=R.formatError(n),await _.error("เพิ่มสินค้าไม่สำเร็จ",n.message),n}finally{f.value=!1}},J=async(l,n)=>{try{f.value=!0;const i=await E.updateProduct(l,n),v=r.value.findIndex(F=>F.id===parseInt(l));return v!==-1&&(r.value[v]=i),await _.success("อัปเดตสินค้าสำเร็จ!",`สินค้า "${i.name}" ถูกอัปเดตแล้ว`),i}catch(i){throw b.value=R.formatError(i),await _.error("อัปเดตสินค้าไม่สำเร็จ",i.message),i}finally{f.value=!1}},U=async l=>{const n=r.value.find(v=>v.id===l);if(!n||!(await _.delete("ลบสินค้า",`คุณต้องการลบสินค้า "${n.name}" หรือไม่? การกระทำนี้ไม่สามารถย้อนกลับได้`)).isConfirmed)return!1;try{return f.value=!0,await E.deleteProduct(l),r.value=r.value.filter(v=>v.id!==l),await _.success("ลบสินค้าสำเร็จ!",`สินค้า "${n.name}" ถูกลบแล้ว`),!0}catch(v){throw b.value=R.formatError(v),await _.error("ลบสินค้าไม่สำเร็จ",v.message),v}finally{f.value=!1}};return tt(()=>{p()}),{products:r,categories:S,loading:f,error:b,searchQuery:y,selectedCategory:$,selectedStatus:k,sortBy:h,viewMode:M,currentPage:B,itemsPerPage:w,filteredProducts:u,totalProducts:j,inStockProducts:T,lowStockProducts:x,outOfStockProducts:q,totalPages:z,getStockStatus:G,getStockStatusKey:D,getStockBadgeClass:V,formatCurrency:Y,formatDate:A,loadProducts:p,createProduct:L,updateProduct:J,deleteProduct:U}}const nt={class:"container-fluid py-4 px-5"},at={key:0,class:"text-center py-5"},it={key:1,class:"alert alert-danger",role:"alert"},rt={key:2},ct={class:"row mb-4"},dt={class:"col-lg-6 text-end"},ut={class:"row mb-4"},vt={class:"col-xl-3 col-md-6 mb-3"},mt={class:"card stat-card primary"},ft={class:"card-body"},pt={class:"d-flex justify-content-between align-items-center"},bt={class:"mb-0"},gt={class:"col-xl-3 col-md-6 mb-3"},_t={class:"card stat-card success"},yt={class:"card-body"},kt={class:"d-flex justify-content-between align-items-center"},ht={class:"mb-0"},wt={class:"col-xl-3 col-md-6 mb-3"},xt={class:"card stat-card warning"},Pt={class:"card-body"},Ct={class:"d-flex justify-content-between align-items-center"},St={class:"mb-0"},$t={class:"col-xl-3 col-md-6 mb-3"},Mt={class:"card stat-card info"},Bt={class:"card-body"},Dt={class:"d-flex justify-content-between align-items-center"},Et={class:"mb-0"},jt={class:"card mb-4"},Tt={class:"card-body"},Vt={class:"row align-items-center"},At={class:"col-lg-4 mb-3 mb-lg-0"},Lt={class:"input-group"},Ut={class:"col-lg-2 mb-3 mb-lg-0"},Ft=["value"],Ht={class:"col-lg-2 mb-3 mb-lg-0"},It={class:"col-lg-2 mb-3 mb-lg-0"},Nt={class:"col-lg-2"},Kt={class:"btn-group w-100",role:"group"},Ot={key:0,class:"row"},Qt={class:"card product-card h-100"},Rt={class:"position-relative"},qt={class:"product-image-container"},zt=["src","alt"],Gt={class:"position-absolute top-0 end-0 m-2"},Jt={class:"card-body d-flex flex-column"},Wt={class:"card-title"},Xt={class:"card-text text-muted small"},Yt={class:"card-text"},Zt={class:"mt-auto"},ts={class:"d-flex justify-content-between align-items-center mb-2"},ss={class:"h5 mb-0 text-primary"},es={class:"text-muted"},ls={class:"btn-group w-100",role:"group"},os=["onClick"],ns=["onClick"],as=["onClick"],is={key:1,class:"card"},rs={class:"card-body"},cs={class:"table-responsive"},ds={class:"table table-hover"},us={class:"list-image-container"},vs=["src","alt"],ms={class:"text-muted"},fs={class:"text-primary fw-bold"},ps={class:"btn-group",role:"group"},bs=["onClick"],gs=["onClick"],_s=["onClick"],ys={class:"d-flex justify-content-between align-items-center mt-4"},ks={class:"text-muted"},hs={class:"pagination pagination-sm mb-0"},ws=["onClick"],xs={__name:"Products",setup(r){const S=et(),f=m(!1),{products:b,categories:y,loading:$,error:k,searchQuery:h,selectedCategory:M,selectedStatus:B,sortBy:w,viewMode:p,currentPage:u,itemsPerPage:j,filteredProducts:T,totalProducts:x,inStockProducts:q,lowStockProducts:z,outOfStockProducts:G,totalPages:D,getStockStatus:V,getStockStatusKey:Y,getStockBadgeClass:A,formatCurrency:L,formatDate:J,loadProducts:U,createProduct:l,updateProduct:n,deleteProduct:i}=ot(),v=H=>{S.push(`/products/${H.id}`)},F=H=>{S.push(`/products/${H.id}`)},Z=()=>{console.log("Export products")};return(H,s)=>(c(),d("div",nt,[o($)?(c(),d("div",at,s[10]||(s[10]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"กำลังโหลด...")],-1),t("p",{class:"mt-3 text-muted"},"กำลังโหลดข้อมูลสินค้า...",-1)]))):o(k)?(c(),d("div",it,[s[12]||(s[12]=t("i",{class:"fas fa-exclamation-triangle me-2"},null,-1)),I(" "+a(o(k))+" ",1),t("button",{class:"btn btn-outline-danger btn-sm ms-2",onClick:s[0]||(s[0]=(...e)=>o(U)&&o(U)(...e))},s[11]||(s[11]=[t("i",{class:"fas fa-redo me-1"},null,-1),I("ลองใหม่ ")]))])):(c(),d("div",rt,[t("div",ct,[s[15]||(s[15]=t("div",{class:"col-lg-6"},[t("h2",{class:"mb-0"},"จัดการสินค้า"),t("p",{class:"text-muted"},"จัดการสินค้าทั้งหมดในระบบ")],-1)),t("div",dt,[t("button",{class:"btn btn-primary me-2",onClick:s[1]||(s[1]=e=>f.value=!0)},s[13]||(s[13]=[t("i",{class:"fas fa-plus me-2"},null,-1),I("เพิ่มสินค้าใหม่ ")])),t("button",{class:"btn btn-outline-secondary",onClick:Z},s[14]||(s[14]=[t("i",{class:"fas fa-download me-2"},null,-1),I("ส่งออกข้อมูล ")]))])]),t("div",ut,[t("div",vt,[t("div",mt,[t("div",ft,[t("div",pt,[t("div",null,[s[16]||(s[16]=t("h6",{class:"card-title text-uppercase opacity-75"},"สินค้าทั้งหมด",-1)),t("h2",bt,a(o(x)),1)]),s[17]||(s[17]=t("div",{class:"fs-1 opacity-25"},[t("i",{class:"fas fa-boxes"})],-1))])])])]),t("div",gt,[t("div",_t,[t("div",yt,[t("div",kt,[t("div",null,[s[18]||(s[18]=t("h6",{class:"card-title text-uppercase opacity-75"},"ในสต็อก",-1)),t("h2",ht,a(o(q)),1)]),s[19]||(s[19]=t("div",{class:"fs-1 opacity-25"},[t("i",{class:"fas fa-check-circle"})],-1))])])])]),t("div",wt,[t("div",xt,[t("div",Pt,[t("div",Ct,[t("div",null,[s[20]||(s[20]=t("h6",{class:"card-title text-uppercase opacity-75"},"สต็อกต่ำ",-1)),t("h2",St,a(o(z)),1)]),s[21]||(s[21]=t("div",{class:"fs-1 opacity-25"},[t("i",{class:"fas fa-exclamation-triangle"})],-1))])])])]),t("div",$t,[t("div",Mt,[t("div",Bt,[t("div",Dt,[t("div",null,[s[22]||(s[22]=t("h6",{class:"card-title text-uppercase opacity-75"},"หมดสต็อก",-1)),t("h2",Et,a(o(G)),1)]),s[23]||(s[23]=t("div",{class:"fs-1 opacity-25"},[t("i",{class:"fas fa-times-circle"})],-1))])])])])]),t("div",jt,[t("div",Tt,[t("div",Vt,[t("div",At,[t("div",Lt,[s[24]||(s[24]=t("span",{class:"input-group-text"},[t("i",{class:"fas fa-search"})],-1)),N(t("input",{type:"text",class:"form-control",placeholder:"ค้นหาสินค้า...","onUpdate:modelValue":s[2]||(s[2]=e=>K(h)?h.value=e:null)},null,512),[[lt,o(h)]])])]),t("div",Ut,[N(t("select",{class:"form-select","onUpdate:modelValue":s[3]||(s[3]=e=>K(M)?M.value=e:null)},[s[25]||(s[25]=t("option",{value:""},"หมวดหมู่ทั้งหมด",-1)),(c(!0),d(O,null,Q(o(y),e=>(c(),d("option",{key:e,value:e},a(e),9,Ft))),128))],512),[[W,o(M)]])]),t("div",Ht,[N(t("select",{class:"form-select","onUpdate:modelValue":s[4]||(s[4]=e=>K(B)?B.value=e:null)},s[26]||(s[26]=[t("option",{value:""},"สถานะทั้งหมด",-1),t("option",{value:"in-stock"},"ในสต็อก",-1),t("option",{value:"low-stock"},"สต็อกต่ำ",-1),t("option",{value:"out-of-stock"},"หมดสต็อก",-1)]),512),[[W,o(B)]])]),t("div",It,[N(t("select",{class:"form-select","onUpdate:modelValue":s[5]||(s[5]=e=>K(w)?w.value=e:null)},s[27]||(s[27]=[t("option",{value:"name"},"เรียงตามชื่อ",-1),t("option",{value:"price"},"เรียงตามราคา",-1),t("option",{value:"stock"},"เรียงตามสต็อก",-1),t("option",{value:"date"},"เรียงตามวันที่",-1)]),512),[[W,o(w)]])]),t("div",Nt,[t("div",Kt,[t("button",{type:"button",class:g(["btn btn-outline-secondary",{active:o(p)==="grid"}]),onClick:s[6]||(s[6]=e=>p.value="grid")},s[28]||(s[28]=[t("i",{class:"fas fa-th"},null,-1)]),2),t("button",{type:"button",class:g(["btn btn-outline-secondary",{active:o(p)==="list"}]),onClick:s[7]||(s[7]=e=>p.value="list")},s[29]||(s[29]=[t("i",{class:"fas fa-list"},null,-1)]),2)])])])])]),o(p)==="grid"?(c(),d("div",Ot,[(c(!0),d(O,null,Q(o(T),e=>(c(),d("div",{key:e.id,class:"col-xl-3 col-lg-4 col-md-6 mb-4"},[t("div",Qt,[t("div",Rt,[t("div",qt,[t("img",{src:e.image,class:"card-img-top product-image",alt:e.name},null,8,zt)]),t("div",Gt,[t("span",{class:g(["badge",o(A)(e.stock)])},a(o(V)(e.stock)),3)])]),t("div",Jt,[t("h6",Wt,a(e.name),1),t("p",Xt,a(e.category),1),t("p",Yt,a(e.description),1),t("div",Zt,[t("div",ts,[t("span",ss,a(o(L)(e.price)),1),t("small",es,"สต็อก: "+a(e.stock),1)]),t("div",ls,[t("button",{class:"btn btn-outline-primary btn-sm",onClick:P=>v(e)},s[30]||(s[30]=[t("i",{class:"fas fa-edit"},null,-1)]),8,os),t("button",{class:"btn btn-outline-info btn-sm",onClick:P=>F(e)},s[31]||(s[31]=[t("i",{class:"fas fa-eye"},null,-1)]),8,ns),t("button",{class:"btn btn-outline-danger btn-sm",onClick:P=>o(i)(e.id)},s[32]||(s[32]=[t("i",{class:"fas fa-trash"},null,-1)]),8,as)])])])])]))),128))])):(c(),d("div",is,[t("div",rs,[t("div",cs,[t("table",ds,[s[37]||(s[37]=t("thead",null,[t("tr",null,[t("th",null,"รูปภาพ"),t("th",null,"ชื่อสินค้า"),t("th",null,"หมวดหมู่"),t("th",null,"ราคา"),t("th",null,"สต็อก"),t("th",null,"สถานะ"),t("th",null,"วันที่เพิ่ม"),t("th",null,"การจัดการ")])],-1)),t("tbody",null,[(c(!0),d(O,null,Q(o(T),e=>(c(),d("tr",{key:e.id},[t("td",null,[t("div",us,[t("img",{src:e.image,class:"product-thumbnail",alt:e.name},null,8,vs)])]),t("td",null,[t("div",null,[t("strong",null,a(e.name),1),s[33]||(s[33]=t("br",null,null,-1)),t("small",ms,a(e.sku),1)])]),t("td",null,a(e.category),1),t("td",fs,a(o(L)(e.price)),1),t("td",null,a(e.stock),1),t("td",null,[t("span",{class:g(["badge",o(A)(e.stock)])},a(o(V)(e.stock)),3)]),t("td",null,a(o(J)(e.createdAt)),1),t("td",null,[t("div",ps,[t("button",{class:"btn btn-outline-primary btn-sm",onClick:P=>v(e)},s[34]||(s[34]=[t("i",{class:"fas fa-edit"},null,-1)]),8,bs),t("button",{class:"btn btn-outline-info btn-sm",onClick:P=>F(e)},s[35]||(s[35]=[t("i",{class:"fas fa-eye"},null,-1)]),8,gs),t("button",{class:"btn btn-outline-danger btn-sm",onClick:P=>o(i)(e.id)},s[36]||(s[36]=[t("i",{class:"fas fa-trash"},null,-1)]),8,_s)])])]))),128))])])])])])),t("div",ys,[t("div",null,[t("small",ks," แสดง "+a(Math.min((o(u)-1)*o(j)+1,o(x)))+" - "+a(Math.min(o(u)*o(j),o(x)))+" จาก "+a(o(x))+" รายการ ",1)]),t("nav",null,[t("ul",hs,[t("li",{class:g(["page-item",{disabled:o(u)===1}])},[t("a",{class:"page-link",href:"#",onClick:s[8]||(s[8]=X(e=>u.value=o(u)-1,["prevent"]))},"ก่อนหน้า")],2),(c(!0),d(O,null,Q(o(D),e=>(c(),d("li",{class:g(["page-item",{active:o(u)===e}]),key:e},[t("a",{class:"page-link",href:"#",onClick:X(P=>u.value=e,["prevent"])},a(e),9,ws)],2))),128)),t("li",{class:g(["page-item",{disabled:o(u)===o(D)}])},[t("a",{class:"page-link",href:"#",onClick:s[9]||(s[9]=X(e=>u.value=o(u)+1,["prevent"]))},"ถัดไป")],2)])])])]))]))}},$s=st(xs,[["__scopeId","data-v-1c56a67a"]]);export{$s as default};
